"use strict";infinity.modules["top-bookmarks-top-bookmarks"]=function(){return new Vue({el:"#topBookMarks",data:{isShow:!1,bookData:null,commombookdata:null,commonbookdatashow:null,commonbookdatashoalast:null,isshowmorebookdata:!1,isshowOtherData:!1,otherbookdata:null,secondbookdata:null,threebookdata:null,forthbookdata:null,secondbookmoredata:null,threebookmoredata:null,forthbookmoredata:null,activingindex:-1,isShowSecondbook:!1,tempLen:0,ulwidth:0,tempid:-1,tempidsi:-1,sibookdata:null,FMDid:-1,SMDid:-1,FOMDid:-1,isHavedClick:!1,otherbookmarks:infinity.i18n("otherbookmarks"),settings:infinity.get("infinity-settings"),chromeUrl:infinity.faviconUrl,notBookmarksPermission:infinity.i18n("require_new_permissition",infinity.i18n("name"))+":"+infinity.i18n("get_bookmarks")},created:function(){var i=this;if(chrome.bookmarks)i.openOverhide(),chrome.bookmarks.getTree(function(o){i.bookData=o,i.commombookdata=o[0].children[0].children,i.commucateShow()});else if(!chrome.bookmarks){var o='<button id="startBookmarks">'+i.notBookmarksPermission+"</button>";$("#bookmarkbar").append(o)}$(document).on("click","#startBookmarks",function(){var t=$(this);chrome.permissions.request({permissions:["bookmarks"]},function(o){o&&(t.remove(),chrome.bookmarks.getTree(function(o){i.bookData=o,i.commombookdata=o[0].children[0].children,i.commucateShow()}))})}),$(window).resize(function(o){o.isTrigger||(clearTimeout(this._timer),this._timer=setTimeout(function(){i.commucateShow()},250))}),$("#search-input").on("click",function(o){var t=$(".site-li-boxnot-click");t.is(o.target)||0!==t.has(o.target).length||i.isHavedClick&&(i.isHavedClick=!1,i.hidemainbookdata(),i.hidethebook())}),$(document).on("click",function(o){var t=$(".site-li-boxnot-click");t.is(o.target)||0!==t.has(o.target).length||(i.isHavedClick=!1,i.hidemainbookdata(),i.hidethebook())}),infinity.onMessage("settingBookMarkOpenWay",function(){i.settings=infinity.get("infinity-settings")})},methods:{openOverhide:function(){$(".app-top").css("overflow","visible")},hidethebook:function(){var o=this;o.isshowmorebookdata&&(o.isshowmorebookdata=!1),o.isshowOtherData&&(o.isshowOtherData=!1),o.FMDid=-1},show:function(){var t=this;if(t.openOverhide(),chrome.bookmarks){var o=$("#startBookmarks");0!=o.length&&o.remove(),chrome.bookmarks.getTree(function(o){t.bookData=o,t.commombookdata=o[0].children[0].children,t.commucateShow()})}},hide:function(){var o=$("#topSites"),t=$(".home-infinity");0!=o.length?(o.css("top","0px"),t.css("top","28px")):(0!=o.length&&"none"!=o.css("display")&&o.css("top","0px"),t.css("top","20px")),this.isShow=!1},initSecondbook:function(o,i,t){var e=this;if(this.isHavedClick&&(!e.isShowSecondbook||i!=this.activingindex)){this.hidemainbookdata();var s=$(t.currentTarget),a=$("body").width(),n=s.offset().left;chrome.bookmarks.getChildren(o,function(o){if(0==o.length){var t={title:infinity.i18n("empty"),href:"/modules/topBookMarks/img/empt.png"};o.push(t)}e.hidethebook(),e.secondbookdata=o,e.activingindex=i,e.showthisbook(i),e.$nextTick(function(){a-n<360&&s.find(".first-secondbook-box").css({right:-8,left:"auto"})})})}},initClickBookData:function(o,t,i){if(this.isHavedClick)return this.isHavedClick=!1,this.hidemainbookdata(),void this.hidethebook();this.isHavedClick=!0,this.initSecondbook(o,t,i)},showthisbook:function(o){this.isShowSecondbook=!0},hideSecondbook:function(){this.activingindex=-1,this.isShowSecondbook=!1},openbookmarks:function(o,t){t||(SETTING.isOpenBookmarkInNewTab?chrome.tabs.create({url:o},function(){}):chrome.tabs.update({url:o},function(){}))},hidemainbookdata:function(o){this.hidethebook(),this.activingindex=o,this.isShowSecondbook=!1,this.tempid=-1,this.tempidsi=-1,this.SMDid=-1,this.FOMDid=-1},commucateShow:function(){var o=$("#more-bookmark-box").width(),t=$("body").width()-o;this.ulwidth=t;var i=Math.ceil(t/60),e=Math.ceil(t/180),s=Math.ceil((i+e)/2);this.tempLen=s,$("#ulbookdatashowbox").css("maxWidth",t-16),this.dealbookdata()},dealbookdata:function(){this.commombookdata&&(this.commonbookdatashow=this.commombookdata.slice(0,this.tempLen),this.$nextTick(function(){var o=0;if($("#ulbookdatashowbox>ul>li").each(function(){o+=$(this).outerWidth()}),o<200)return this.commombookdata.length<=this.tempLen?$(".more-bookmark-is-Show").css("visibility","hidden"):$(".more-bookmark-is-Show").css("visibility","visible"),void $("#topBookMarks").css("visibility","visible");o<this.ulwidth-26&&(this.commombookdata.length<=this.tempLen?$(".more-bookmark-is-Show").css("visibility","hidden"):$(".more-bookmark-is-Show").css("visibility","visible"),$("#topBookMarks").css("visibility","visible")),o>this.ulwidth-26&&(this.tempLen=this.tempLen-1,this.dealbookdata())}))},downloadmoredata:function(o){var t=this;chrome.bookmarks.getChildren(o,function(o){t.secondbookdata=o})},initthreeDate:function(e,o){var s=this,a=$(o.target);if(s.tempid!=e){var t=$("body").width(),n=$("body").height(),h=t-a.offset().left-350,r=a.offset().top,d=Math.ceil(n-r),c=0,k=0,m=0;chrome.bookmarks.getChildren(e,function(o){var t=o.length;if(0==t){var i={title:infinity.i18n("empty"),href:"/modules/topBookMarks/img/empt.png"};o.push(i),c=26,m=r}0!=t&&((k=26*t+2)<d-26?(c=d,m=r):d<=k&&(c=d,m=k<n?n-k-26:30)),40<c&&(c-=10),m<30&&(m=30),s.threebookdata=o,s.tempid=e,s.$nextTick(function(){350<h?$(".threebook-box").css({left:a.offset().left+350-11,top:m,"max-height":n-80}):$(".threebook-box").css({left:a.offset().left-200,top:m,"max-height":n-80})})})}},openthreshowdata:function(o){this.tempid=o,this.tempidsi=-1},openforthshowdata:function(o){this.tempidsi=o},initforthData:function(e,o){var s=this;if(s.tempidsi!=e||-1==e){var t=$(o.target),a=t.offset(),i=$("body").width(),n=$("body").height(),h=i-t.offset().left-200,r=t.offset().top,d=Math.ceil(n-r),c=0,k=0,m=0;chrome.bookmarks.getChildren(e,function(o){var t=o.length;if(0==t){var i={title:infinity.i18n("empty"),href:"/modules/topBookMarks/img/empt.png"};o.push(i),c=26,m=r}s.tempidsi=e,s.sibookdata=o,0!=t&&((k=26*t+2)<d-26?(c=d,m=r):d<k&&(c=d,m=k<n?n-k-26:30)),40<c&&(c-=10),m<30&&(m=30),s.$nextTick(function(){200<h?$(".forthbook-box").css({left:a.left+200-11,top:m,"max-height":n-80}):$(".forthbook-box").css({left:a.left-200,top:m,"max-height":n-80})})})}},showMorebookData:function(){this.isHavedClick&&(this.isshowOtherData&&(this.isshowOtherData=!1),this.commonbookdatashoalast=this.commombookdata.slice(this.tempLen,this.commombookdata.length),this.isshowmorebookdata=!0,this.isShowSecondbook=!1)},showinitmorebookdata:function(){this.isHavedClick?(this.isHavedClick=!1,this.hidemainbookdata(),this.hidethebook()):(this.isHavedClick=!0,this.showMorebookData())},otherDataclick:function(){this.isHavedClick?(this.isHavedClick=!1,this.hidemainbookdata(),this.hidethebook()):(this.isHavedClick=!0,this.initohterdata())},initohterdata:function(){if(this.isHavedClick){if(this.isshowmorebookdata&&(this.isshowmorebookdata=!1),this.otherbookdata=this.bookData[0].children[1].children,0==this.otherbookdata.length){var o={title:infinity.i18n("empty"),href:"/modules/topBookMarks/img/empt.png"};this.otherbookdata.push(o)}this.isshowOtherData=!0,this.isShowSecondbook=!1}},openMoreBookDataSecond:function(e,o){var s=this;if(s.FMDid!=e||-1==e){var t=$(o.target).offset(),a=($("body").width(),$("body").height()),n=t.top,h=Math.ceil(a-n),r=0,d=0,c=0;chrome.bookmarks.getChildren(e,function(o){var t=o.length;if(0==t){var i={title:infinity.i18n("empty"),href:"/modules/topBookMarks/img/empt.png"};o.push(i),r=26,c=n}s.FMDid=e,s.secondbookmoredata=o,0!=t&&((d=26*t)<h?(r=h,c=n):h<d&&(r=h,c=d<a?a-d-26:30)),40<r&&(r-=10),c<30&&(c=30),s.$nextTick(function(){$(".firstload-more-book-data").css({right:350,top:c,"max-height":a-80})})})}},hideSecondmoreData:function(o){this.FMDid=o,this.SMDid=-1},hideThreemoreData:function(o){this.SMDid=o,this.FOMDid=-1},openMoreBookDataThree:function(e,o){var s=this;if(s.SMDid!=e||-1==e){var t=$(o.target).offset(),a=($("body").width(),$("body").height()),n=t.top,h=Math.ceil(a-n),r=0,d=0,c=0;chrome.bookmarks.getChildren(e,function(o){var t=o.length;if(0==t){var i={title:infinity.i18n("empty"),href:"/modules/topBookMarks/img/empt.png"};o.push(i),r=26,c=n}s.SMDid=e,s.threebookmoredata=o,0!=t&&((d=26*t)<h?(r=h,c=n):h<d?(r=h,c=d<a?a-d-26:30):r=h),40<r&&(r-=10),c<30&&(c=30),s.$nextTick(function(){$(".secondload-more-book-data").css({right:550,top:c,"max-height":a-80})})})}},openMoreBookDataForth:function(e,o){var s=this;if(s.FOMDid!=e||-1==e){var t=$(o.target).offset(),a=($("body").width(),$("body").height()),n=t.top,h=Math.ceil(a-n),r=0,d=0,c=0;chrome.bookmarks.getChildren(e,function(o){var t=o.length;if(0==t){var i={title:infinity.i18n("empty"),href:"/modules/topBookMarks/img/empt.png"};o.push(i),r=26,c=n}s.FOMDid=e,s.forthbookmoredata=o,0!=t&&((d=26*t)<h?(r=h,c=n):h<d&&(r=h,c=d<a?a-d-26:30)),40<r&&(r-=10),c<30&&(c=30),s.$nextTick(function(){$(".threeload-more-book-data").css({right:750,top:c,"max-height":a-80})})})}},hideForthmoreData:function(o){this.FOMDid=o}}})};