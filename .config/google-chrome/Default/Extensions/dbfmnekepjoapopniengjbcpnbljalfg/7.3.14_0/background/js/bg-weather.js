"use strict";var bgWeather={data:{today:{code:"29",temp:{current:"NaN",high:"NaN",low:"37"},text:"NaN",humidity:"NaN",pressure:"NaN",wind:"NaN"},future:[{code:"34",date:(new Date).getTime()+864e5,high:"",low:"",text:"NaN"},{code:"28",date:(new Date).getTime()+1728e5,high:"",low:"",text:"NaN"},{code:"30",date:(new Date).getTime()+2592e5,high:"",low:"",text:"NaN"},{code:"30",date:(new Date).getTime()+3456e5,high:"",low:"",text:"NaN"},{code:"39",date:(new Date).getTime()+432e6,high:"",low:"",text:"NaN"}],location:{city:"Locating",country:"..."},woeid:2459115},init:function(){var t=this;infinity.alarms.onAlarm("queryWeather",function(e){t.queryWeather()}),t.initData(function(){infinity.alarms.create("queryWeather",{periodInMinutes:30})}),infinity.onMessage("recoverySuccess",function(){var e=infinity.setting("woeid");e&&t.queryWeather(e)})},initData:function(t){var i=this;try{i.tempUnitC=infinity.setting("tempUnitC")}catch(e){i.tempUnitC=!0}infinity.get("infinity-weather",!0,function(e){e&&t&&t()}),infinity.init("infinity-weather",i.data,!0,function(){t&&t()})},tempUnitC:!0,transUnit:function(t){try{var e=parseInt(t);return this.tempUnitC?Math.round((e-32)/1.8):e}catch(e){return t}},setTheCityWeather:function(t){var i=this;i.initData(function(){i.queryCity(t,function(e){i.queryWeather(e.woeid)})}),infinity.get("infinity-weather",!0,function(e){e&&i.queryCity(t,function(e){i.queryWeather(e.woeid)})})},queryCity:function(e,i){var t="https://www.yahoo.com/news/_td/api/resource/WeatherSearch;text="+encodeURIComponent(e)+"?bkt=news-d-147&device=desktop&feature=cacheContentCanvas%2Ccanvass%2Cfeaturebar%2CdeferModalCluster%2CspecRetry&intl="+chrome.i18n.getUILanguage()+"&lang="+chrome.i18n.getUILanguage()+"&partner=none&region=US&site=fp&tz=America%2FLos_Angeles&ver=2.0.2213002&returnMeta=true&t="+(new Date).getTime();$.ajax({url:t,dataType:"json"}).done(function(e){try{var t=e.data.splice(0,20);t.length&&i&&i(t[0])}catch(e){}})},queryWeather:function(i){infinity.get("infinity-weather",!0,function(e){var a=void 0,t="https://www.yahoo.com/news/_tdnews/api/resource/WeatherService;woeids=%5B"+(a=i||e.woeid)+"%5D?t="+Date.now();$.ajax({url:t,dataType:"json"}).done(function(e){try{var t=e.weathers[0];if(t&&t.location&&t.location.woeid==a&&t.provider&&t.provider.name){var i=t.observation,n={};n.today={code:i.conditionCode,temp:{current:i.temperature.now,high:i.temperature.high,low:i.temperature.low},text:i.conditionDescription,humidity:i.humidity+" %",pressure:i.barometricPressure.toFixed(1)+" bar",wind:i.windSpeed+" mph"},n.future=[],n.location={},n.location.country=t.location.countryName,n.location.city=t.location.displayName,n.woeid=a,infinity.setting("woeid",a),t.forecasts.daily.map(function(e,t){if(0<t&&t<6){var i={};i.code=e.conditionCode,i.date=new Date(e.observationTime.timestamp),i.high=e.temperature.high,i.low=e.temperature.low,i.text=e.conditionDescription,n.future.push(i)}}),infinity.set("infinity-weather",n,!0),infinity.sendMessage("updateWeather")}}catch(e){}})})}};